= render 'tabs'

- content_for :head do
  :javascript
    $(function() { initMemberships(#{current_user.id}, #{collection.id}, #{collection.layers.map{|x| {id: x.id, name: x.name}}.to_json}); });

.tabsline
  Read and Update permissions shown for:
  %select{ko(options: :layers, value: :selectedLayer, optionsText: "'name'", optionsCaption: "'All layers'")}
  %br/
  %br/

  .tablewrapp
    %table.GralTable
      %tr
        - if collection_admin?
          %th{:style => 'width:140px'}
        %th Name
        %th Admin?
        %th Can Read?
        %th Can Update?
        %th
      <!-- ko foreach: memberships -->
      %tr{:style => 'height:32px'}
        - if collection_admin?
          %td
        %td{ko(text: :userDisplayName)}
        %td{ko(html: :adminUI)}
        <!-- ko if: isCurrentUser() -->
        %td Yes
        %td Yes
        <!-- /ko -->
        <!-- ko if: !isCurrentUser() -->
        %td
          %input{ko(checked: :canRead), type: :checkbox}
        %td
          %input{ko(checked: :canWrite), type: :checkbox}
        <!-- /ko -->
        %td
          - if collection_admin?
            <!-- ko if: !isCurrentUser() -->
            = ko_link_to 'delete', '$root.destroyMembership', class: 'icon fdelete black'
            <!-- /ko -->
      <!-- /ko -->
      - if collection_admin?
        %tr{:style => 'height:32px'}
          %td
            %button.cadd#add_member Add member
          %td= text_field_tag :member_email, '', :size => 60, :placeholder => 'Search by email...'
          %td
          %td
